<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>

<title>Sales Project Map</title>

<link rel="stylesheet"
href="https://unpkg.com/leaflet/dist/leaflet.css"/>

<style>
body{
  margin:0;
}

#map{
  height:100vh;
}
</style>
</head>

<body>

<div id="map"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>

// ===============================
// âœ… CREATE MAP
// ===============================

var map = L.map('map').setView([13.7367,100.5231],11);

L.tileLayer(
'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'
).addTo(map);


// ===============================
// âœ… GOOGLE SHEET CSV
// ===============================

const sheetURL =
"https://docs.google.com/spreadsheets/d/e/2PACX-1vQkOdRULyIfGZRazPhqFn4vQvsCBuxOC1SAEwwiiecwQ_GbFx8_aTCeWa8EqZLPphRGHOnClatbqeKt/pub?output=csv";


// ===============================
// âœ… LOAD DATA FROM SHEET
// ===============================

fetch(sheetURL)
.then(res => res.text())
.then(csv => {

const rows = csv.split("\n");
const headers = rows[0].split(",");

// à¸«à¸² column à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´
const nameIndex = headers.indexOf("Project");
const typeIndex = headers.indexOf("Type");
const priceIndex = headers.indexOf("Min Price");
const latIndex = headers.indexOf("Latitude");
const lngIndex = headers.indexOf("Longitude");

rows.slice(1).forEach(row => {

const cols = row.split(",");

const name = cols[nameIndex];
const type = cols[typeIndex];
const price = cols[priceIndex];

const lat = parseFloat(cols[latIndex]);
const lng = parseFloat(cols[lngIndex]);

if(!lat || !lng) return;


// ===============================
// âœ… CREATE MARKER
// ===============================

var marker = L.marker([lat,lng]).addTo(map);

marker.bindPopup(`
<b>${name}</b><br>
ğŸ  ${type}<br>
ğŸ’° ${price} MB
`);

});

});

</script>

</body>
</html>
